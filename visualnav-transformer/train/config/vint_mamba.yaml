project_name: vint-mamba
run_name: vint-mamba

# training setup
use_wandb: True
train: True
batch_size: 128
eval_batch_size: 64
epochs: 100
gpu_ids: [0]
num_workers: 12
lr: 1e-4 
optimizer: adamw
clipping: True
max_norm: 1.
scheduler: "cosine"
warmup: True 
warmup_epochs: 4
cyclic_period: 10
plateau_patience: 3
plateau_factor: 0.5
seed: 0

# model params
model_type: mamba_vint  # Use Mamba-based model
obs_encoder: "efficientnet-b0"
obs_encoding_size: 512
late_fusion: False

# Mamba-specific parameters (优化后配置)
mamba_d_state: 64        # 增加状态空间维度提升模型容量
mamba_d_conv: 4           # Convolution kernel size
mamba_expand: 2           # Expansion factor  
mamba_headdim: 64        # 增加head维度提升表达能力
mamba_num_blocks: 4       # 增加层数提高模型深度
mamba_chunk_size: 256     # Chunk size - Mamba内部分chunk处理
mamba_use_mem_eff: True   # 禁用mem_eff避免额外显存开销

# normalization for the action space
normalize: True

# context - 先用较小值确保训练稳定
context_type: temporal
context_size: 5  # 降低到合理范围，避免小batch下过拟合

# tradeoff between action and distance prediction loss
alpha: 0.5

# distance bounds for distance and action and distance predictions 
distance:
  min_dist_cat: 0
  max_dist_cat: 20
action:
  min_dist_cat: 0
  max_dist_cat: 10
close_far_threshold: 10

# action output params
len_traj_pred: 5
learn_angle: True

# dataset specific parameters
image_size: [80, 60] # width, height
goal_type: "image"

datasets:
  go_stanford:
    data_folder: /workspace/datasets/go_stanford
    train: vint_train/data/data_splits/go_stanford/train/
    test: vint_train/data/data_splits/go_stanford/test/
    end_slack: 0
    goals_per_obs: 2
    negative_mining: True

# logging stuff
print_log_freq: 100
image_log_freq: 1000
num_images_log: 8
pairwise_test_freq: 0
eval_fraction: 0.25
wandb_log_freq: 10
eval_freq: 1

